<ion-header>
	<ion-toolbar color="primary">
		<ion-title *ngIf="!member">Invite member to join</ion-title>
		<ion-title *ngIf="member">Invite {{member|memberTitle}} to join</ion-title>
		<ion-buttons slot="end">
			<ion-button role="close" (click)="close()">
				<ion-icon name="close-outline"></ion-icon>
			</ion-button>
		</ion-buttons>
	</ion-toolbar>
</ion-header>
<ion-content>
	<ion-segment [(ngModel)]="tab" (ionChange)="onTabChanged()">
		<ion-segment-button value="email">By Email</ion-segment-button>
		<ion-segment-button value="sms">By SMS</ion-segment-button>
		<ion-segment-button value="link">Get link</ion-segment-button>
	</ion-segment>
	<form>
		<ion-item>
			<ion-label position="stacked" color="medium">
				<ng-container *ngIf="tab !== 'link'">To</ng-container>
				<ng-container *ngIf="tab === 'link'">Invite link</ng-container>
			</ion-label>
			<ion-input *ngIf="tab === 'email'" placeholder="email@address"
								 [required]="true"
								 [disabled]="creatingInvite"
								 [formControl]="email"
			></ion-input>
			<ion-input *ngIf="tab === 'sms'" [disabled]="creatingInvite" placeholder="phone #"
								 [formControl]="phone"></ion-input>
			<ion-input *ngIf="tab === 'link'"
								 readonly="readonly"
								 [disabled]="creatingInvite"
								 [value]="link ?? 'Generating...'"
								 [color]="link ? 'primary' : 'medium'"
			></ion-input>
			<ion-buttons *ngIf="tab === 'link' && link" slot="end">
				<ion-button color="medium" (click)="copyLinkToClipboard()"><ion-icon name="copy-outline"></ion-icon></ion-button>
			</ion-buttons>
		</ion-item>
		<ion-item>
			<ion-label color="medium" position="stacked">Message</ion-label>
			<ion-textarea [disabled]="creatingInvite" [formControl]="message" maxlength="100"></ion-textarea>
		</ion-item>
		<ion-card-content *ngIf="tab === 'email'">
			<p>
				<ion-text *ngIf="!email.value" color="danger">Email address is required for sending an invite.</ion-text>
				<ion-text *ngIf="email.value && !email.valid" color="danger">A valid email address is required for sending an invite.</ion-text>
				&nbsp;
			</p>
			<ion-button (click)="sendInvite()" [disabled]="!email.valid">
				<ion-icon name="mail-outline" slot="start"></ion-icon>
				<ion-label>Send invite</ion-label>
			</ion-button>
			<ion-button disabled fill="clear" color="medium" style="text-transform: none">or</ion-button>
			<ion-button (click)="composeEmail()" fill="outline" [disabled]="!email.valid">
				<ion-icon name="mail-outline" slot="start"></ion-icon>
				<ion-label>Compose email</ion-label>
			</ion-button>
		</ion-card-content>
		<ion-card-content *ngIf="tab === 'sms'">
			<ion-button
				style="text-transform: none"
				fill="outline"
				(click)="composeSMS()"
			>
				<ion-icon name="phone-portrait-outline" slot="start"></ion-icon>
				<ion-label>Compose SMS</ion-label>
				<ion-spinner name="lines-small" color="medium" class="ion-margin-start" slot="end"
										 *ngIf="creatingInvite"></ion-spinner>
			</ion-button>
			<p>
				<ion-text color="medium">This works on mobiles or if your computer supports sending SMS</ion-text>
			</p>
		</ion-card-content>
		<ion-card-content *ngIf="error">
			<ion-text class="ion-margin" color="danger">{{error}}</ion-text>
		</ion-card-content>
	</form>

	<ng-container *ngIf="tab === 'link'">
		<ion-card-content>
			<ion-button fill="outline" (click)="copyLinkWithInviteTextToClipboard()" [disabled]="creatingInvite || !link">
				<ion-icon slot="start" name="copy-outline"></ion-icon>
				<ion-label style="text-transform: none">Copy invite text with a link</ion-label>
			</ion-button>
		</ion-card-content>
	</ng-container>
</ion-content>
