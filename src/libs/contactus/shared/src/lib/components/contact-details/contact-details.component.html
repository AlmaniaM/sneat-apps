<ion-grid class="ion-grid-layout">
  <ion-row>
    <ion-col>
      <ion-card>
        <ion-item class="sneat-no-end-padding">
          <ion-label style="font-weight: bold">
            <ng-container *ngIf="contact?.brief?.gender">
              <ng-container [ngSwitch]="contact?.brief?.gender">
                <span *ngSwitchCase="'male'" class="ion-margin-end">ðŸ§‘</span>
                <span *ngSwitchCase="'female'" class="ion-margin-end">ðŸ‘©</span>
                <ion-icon name="person" *ngSwitchDefault></ion-icon>
              </ng-container>
              {{(contact|contactTitle) || contact?.brief?.shortTitle || (contact?.dto?.userID === currentUserId ? 'Me' : '(no title)')}}
            </ng-container>
          </ion-label>
          <ion-buttons slot="end">
            <ion-button color="medium" title="Edit member" (click)="goMemberPage('edit-member')">
              <ion-icon name="create"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-item>
        <ion-item-divider mode="md" *ngIf="contact?.brief?.gender && relatedAs">
          <ion-label *ngIf="contact?.brief?.gender === 'male' && relatedAs === 'child'">My son</ion-label>
          <ion-label *ngIf="contact?.brief?.gender === 'female' && relatedAs === 'child'">My daughter</ion-label>
          <ion-label *ngIf="contact?.brief?.gender === 'male' && relatedAs === 'spouse'">My husband</ion-label>
          <ion-label *ngIf="contact?.brief?.gender === 'female' && relatedAs === 'spouse'">My wife</ion-label>
        </ion-item-divider>

        <sneat-contact-dob [contact]="contact"></sneat-contact-dob>
      </ion-card>

      <sneat-relationship-form *ngIf="contact?.brief?.userID !== currentUserID"
        [team]="team"
        [(relationship)]="relatedAs"
        [ageGroup]="contact?.brief?.ageGroup"
        (relationshipChange)="onRelatedAsChanged($event)"
      ></sneat-relationship-form>

    </ion-col>
    <ion-col>
      <ion-card>
        <ion-list>
          <sneat-contact-modules-menu [team]="team" [contact]="contact"></sneat-contact-modules-menu>
        </ion-list>
      </ion-card>
    </ion-col>
  </ion-row>
</ion-grid>

<ion-segment class="ion-margin-horizontal" color="primary" [(ngModel)]="tab">
  <ion-segment-button value="communicationChannels" *ngIf="hideForContactTypes(['pet'])">
    Email/phone
  </ion-segment-button>
  <ion-segment-button value="relatedContacts">
    Contacts
  </ion-segment-button>
  <ion-segment-button value="roles" *ngIf="hideForContactTypes(['pet'])">
    Roles
  </ion-segment-button>
  <ion-segment-button value="locations" *ngIf="hideForContactTypes(['pet'])">
    Locations
  </ion-segment-button>
</ion-segment>

<sneat-contact-contacts *ngIf="tab === 'communicationChannels'" [contact]="contact"></sneat-contact-contacts>

<ion-card *ngIf="tab === 'relatedContacts'">
  <ion-item color="light">
    <ion-label>Related contacts</ion-label>
  </ion-item>
  <ion-item *ngIf="!relatedContacts?.length">
    <ion-label color="medium">No related contacts</ion-label>
  </ion-item>
  <ion-item *ngIf="contact?.dto?.relatedContacts">
    <ion-badge *ngFor="let m of relatedContacts"
               color="light" style="cursor: pointer"
               (click)="goMember(m.id)"
    >
      {{m.brief.relatedAs}} of {{m.brief.title}}
    </ion-badge>
    <ion-buttons slot="end">
      <ion-button (click)="addRelatedContact($event)">Add</ion-button>
    </ion-buttons>
  </ion-item>
</ion-card>

<sneat-contact-locations *ngIf="tab === 'roles'" [team]="team"
                         [contact]="contact"></sneat-contact-locations>


<sneat-contact-roles-input *ngIf="tab === 'locations'" [team]="team"
                           [contact]="contact"></sneat-contact-roles-input>
