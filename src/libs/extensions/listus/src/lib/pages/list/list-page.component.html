<ion-header>
	<ion-toolbar color="light">
		<ion-buttons slot="start">
			<ion-back-button [defaultHref]="defaultBackUrl"></ion-back-button>
		</ion-buttons>
		<ion-title *ngIf="list?.brief else noTitle">
			<ng-container *ngIf="list?.brief?.emoji"><span style="margin-right: 0.3em">{{list?.brief?.emoji}}</span>
			</ng-container>
			<ng-container [ngSwitch]="list?.brief?.type">
				<ng-container *ngSwitchCase="'to-buy'">{{list?.brief?.title}} to buy</ng-container>
				<ng-container *ngSwitchCase="'to-cook'">{{list?.brief?.title}} to cook</ng-container>
				<ng-container *ngSwitchCase="'recipes'">{{list?.brief?.title}}</ng-container>
				<ng-container *ngSwitchCase="'to-watch'">To watch: {{list?.brief?.title}}</ng-container>
				<ng-container *ngSwitchDefault>
					<span *ngIf="listGroupTitle">{{listGroupTitle}}: </span> {{list?.brief?.title}}
				</ng-container>
			</ng-container>
		</ion-title>
		<ng-template #noTitle>
			<ion-title>List</ion-title>
		</ng-template>
		<ion-buttons slot="end">
			<ion-button (click)="newItem()">
				<ion-icon name="add"></ion-icon>
			</ion-button>
		</ion-buttons>
	</ion-toolbar>
</ion-header>
<ion-content class="cardy">
	<img alt="List image" *ngIf="list?.brief?.img" [src]="list?.brief?.img">

	<ion-card>
		<!--		<div class="segment" [ngSwitch]="list?.brief?.type">-->
		<!--			<ion-segment [(ngModel)]="segment" *ngSwitchCase="'recipes'">-->
		<!--				<ion-segment-button value="list">Ingredients</ion-segment-button>-->
		<!--				<ion-segment-button value="recipe">Recipe</ion-segment-button>-->
		<!--			</ion-segment>-->
		<!--			<ion-segment *ngSwitchDefault [(ngModel)]="segment">-->
		<!--				<ion-segment-button value="list" title="Brief list">-->
		<!--					<ion-icon name="list-outline"></ion-icon>-->
		<!--				</ion-segment-button>-->
		<!--				<ion-segment-button value="cards" title="Cards">-->
		<!--					<ion-icon name="albums-outline"></ion-icon>-->
		<!--				</ion-segment-button>-->
		<!--				<ion-segment-button value="aisle" *ngIf="list && list.id.indexOf('groceries') >= 0">-->
		<!--					<ion-label>By aisle</ion-label>-->
		<!--				</ion-segment-button>-->
		<!--				<ion-segment-button value="discover" title="Discover" *ngIf="listType === 'to-watch' || listType === 'recipes'">-->
		<!--					<ion-icon name="compass"></ion-icon>-->
		<!--				</ion-segment-button>-->
		<!--				<ion-segment-button value="settings" title="Shared with">-->
		<!--					<ion-icon name="people"></ion-icon>-->
		<!--				</ion-segment-button>-->
		<!--			</ion-segment>-->
		<!--		</div>-->

		<ion-segment [(ngModel)]="doneFilter" (ionChange)="onIsDoneFilterChanged($event)">
			<ion-segment-button value="all" style="text-transform: none">All</ion-segment-button>
			<ion-segment-button value="active" style="text-transform: none">Active</ion-segment-button>
			<ion-segment-button value="completed" style="text-transform: none">Completed</ion-segment-button>
		</ion-segment>

		<!--		<p class="ion-padding" *ngIf="!listItems && !list?.dto && !list?.dto !== null">Loading...</p>-->

		<ng-container *ngIf="segment === 'recipes' && list?.dto">
			<p class="ion-padding" *ngIf="list?.dto?.note">
				{{list?.dto?.note}}
			</p>
		</ng-container>

		<ion-list>
			<ion-reorder-group (ionItemReorder)="reorder($event)" [disabled]="!isReordering && doneFilter !== 'all'">
				<ion-reorder *ngFor="let item of filteredListItems; trackBy: itemId">
					<sneat-list-item
						[showDoneCheckbox]="doneFilter !== 'all'"
						[doneFilter]="doneFilter"
						[listItemWithUiState]="item"
						[listItems]="filteredListItems"
						[team]="team"
						[list]="list"
						(itemClicked)="goListItem($event)"
						(listChanged)="setList($event)"
					></sneat-list-item>
				</ion-reorder>
			</ion-reorder-group>
		</ion-list>

		<ng-container *ngIf="segment !== 'settings' && listType !== 'to-watch' && listType !== 'recipes'">
			<sneat-new-list-item [team]="team" [list]="list" [isDone]="doneFilter === 'completed'" [disabled]="isPersisting"
													 #newListItem>
			</sneat-new-list-item>
		</ng-container>
	</ion-card>


	<ng-container [ngSwitch]="segment">
		<div *ngSwitchCase="'discover'">
			<div class="ion-padding" *ngIf="listType === 'to-watch'">
				<h1>Discover good movies</h1>
				<p>We give you recommendations based on what you added previously to this watchlist and your rating to the
					watched movies.</p>
				<p>The more movies you rate the better recommendations we can give.</p>
				<p>Recommendations in your personal watchlist and in kids watchlist would be different so it's safe to use
					with your family.</p>
				<ion-button expand="full">Got it, show recommendations</ion-button>
			</div>
			<div class="ion-padding" *ngIf="listType === 'recipes'">
				<h1>Discover great recipes</h1>
				<p>We give you recommendations based on your rating to previous recipes in this list.</p>
				<p>The more recipes you rate the better recommendations we can give.</p>
				<ion-button expand="full">Got it, show recommendations</ion-button>
			</div>
		</div>
	</ng-container>

	<sneat-shared-with *ngIf="segment === 'settings'" title="This list is shared with"></sneat-shared-with>

	<ng-container *ngIf="segment === 'list' && filteredListItems">
		<div class="ion-padding" style="text-align: center">
			<ion-text class="ion-padding" color="medium">
				<span class="hint-sentence"> Swipe left to remove item.</span>
				<span class="hint-sentence">Swipe right to mark as completed.</span>
				<span class="hint-sentence">Drag & drop to reorder.</span>
			</ion-text>
		</div>
		<ion-grid>
			<ion-row>
				<ion-col>
					<ion-button [disabled]="isReactivatingCompleted" color="light" expand="full"
											(click)="reactivateCompleted()"
					>
						<ion-icon *ngIf="!isReactivatingCompleted" name="refresh-outline" slot="start"></ion-icon>
						<ion-spinner *ngIf="isReactivatingCompleted" slot="start"></ion-spinner>
						<ion-label>Reactivate completed</ion-label>
					</ion-button>
				</ion-col>
				<ion-col *ngIf="doneFilter !== 'active'">
					<ion-button color="warning" expand="full" (click)="deleteCompleted()">
						<ion-icon name="trash-outline" slot="start"></ion-icon>
						<ion-label>Delete completed</ion-label>
					</ion-button>
				</ion-col>
				<ion-col *ngIf="doneFilter === 'all'">
					<ion-button color="danger" expand="full" (click)="deleteAll()">
						<ion-icon name="trash-bin-outline" slot="start"></ion-icon>
						<ion-label>Clear list</ion-label>
					</ion-button>
				</ion-col>
			</ion-row>
		</ion-grid>
		<div class="ion-padding" *ngIf="list?.brief?.type === 'recipes'">
			<ion-button expand="block" (click)="openCopyListItemsDialog()">
				ðŸ›’ Add to groceries
			</ion-button>
			<ion-button expand="block" fill="clear" (click)="goGroceries()">
				ðŸ“‹ Groceries shopping list
			</ion-button>
		</div>
	</ng-container>
	<div *ngIf="segment === 'cards' && list?.dto?.items" [ngSwitch]="list?.brief?.type"
			 style="padding-top: 0.5em; padding-bottom: 0.5em">
		<ng-container *ngSwitchCase="'watch'">
			<!--			<sneat-movie-card *ngFor="let listItem of filteredListItems; trackBy: itemId"-->
			<!--												[movie]="listItem"-->
			<!--												[showWatchedMovies]="!isHideWatched"-->
			<!--												[team]="team"-->
			<!--												[list]="list"-->
			<!--												(goMovie)="goMoviePage($event)"-->
			<!--												(listChanged)="setList($event)"-->
			<!--			></sneat-movie-card>-->
		</ng-container>
		<ng-container *ngSwitchDefault>
			<ion-card *ngFor="let item of filteredListItems; trackBy: itemId"
								button
								(click)="goListItem(item.brief)"
			>

				<img alt="Item image" *ngIf="item.brief.img" [src]="item.brief.img">
				<ion-card-content>
					<h2>{{item.brief.title}}</h2>
					Short description here
				</ion-card-content>
			</ion-card>
		</ng-container>
	</div>
</ion-content>
<ion-footer *ngIf="(segment === 'list' || segment === 'cards') && list?.brief?.type === 'to-watch'">
	<ion-toolbar>
		<ion-grid class="grid-layout">
			<ion-row>
				<ion-col size="6">
					<ion-item (click)="clickShowWatchedMovies()">
						<!--						<ion-checkbox slot="start" (click)="clickShowWatchedMovies()"></ion-checkbox>-->
						<ion-icon slot="start" *ngIf="!isHideWatched" name="square-outline"></ion-icon>
						<ion-icon slot="start" *ngIf="isHideWatched" name="checkbox-outline"></ion-icon>
						<ion-text>Hide watched</ion-text>
					</ion-item>
				</ion-col>
				<ion-col size="6">
					<ion-button expand="full" fill="clear" (click)="removeIsWatchedFromWatchlist(filteredListItems)">
						Delete watched
					</ion-button>
				</ion-col>
			</ion-row>
		</ion-grid>
	</ion-toolbar>
</ion-footer>
